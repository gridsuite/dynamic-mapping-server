[![MPL-2.0 License](https://img.shields.io/badge/license-MPL_2.0-blue.svg)](https://www.mozilla.org/en-US/MPL/2.0/)

# dynamic-mapping-server

To automatically generate the sql schema file you can use the following command:

    mvn package -DskipTests && rm src/main/resources/mappings.sql && java -jar target/gridsuite-mapping-server-1.0.0-SNAPSHOT-exec.jar --spring.jpa.properties.javax.persistence.schema-generation.scripts.action=create 

Parameters are not yet generated by the app. For now the app will not work as intended without any data.

After creating the database and its tables, load **src/main/resources/IEEE14Models.sql** to instantiate some.

---

# How to add a new model

- Call the POST /models/ endpoint with a Model JSON Object
    - (Example: _test/resources/LoadAlphaBeta.json_)

---

# How to add a new equipment type

## Griddyna-app

### For rules:

1) Add [Type] to EquipmentType enum
2) Add properties in EquipmentProperties.[Type]

### For automata:

1) Add [Family] to AutomatonFamily
2) Add properties in AutomatonProperties.[Family]

## Dynamic-mapping-server

1) Add [Type/Family] to utils/EquipmentType

### For rules:

2) Add [Type] to `equipmentTypeToCollectionName` method in Templater
3) Add [Type] to `equipmentTypeToClass` method in Templater
4) Add `get[Type]EquipmentValueMethod` in NetworkServiceImpl
5) Add previous method to `getNetworkValuesFromExistingNetwork` in NetworkServiceImpl
6) Add `getPropertyValuesBy[Type]` in NetworkServiceImpl
7) Add previous method to `matchNetworkToRule` in NetworkServiceImpl

### For automata:

2) Add [Family] to `familyModel` switch in Templater
3) Update `AUTOMATON_IMPORT` if new imports are needed (or create an import constant for each family)

---

# Roadmap

- Create an interface to Delete sets
    - Front-End only, probably via `SetEditor`
- Prefill Sets in `SetEditor`
    - Either put a default set in `parameterDefinitions` (FE & BE) or use first set to prefill all the others (FE only)
- Fetch EquipmentTypes from BE instead of defining them in the Front End
    - Update Data Model and add an `EquipmentController`
- Manage Equipment properties and creates an interface to update/add a type.
    - New endpoints to `EquipmentController`
- Create an interface to import models
    - FE only, add a page with a form to create new model and its parameters
- Directly create the .dyd without using the script.
    - It will need to use `matchNetworkToRule` results and **remove duplicates** from the results.
    - Replicate PowSyBl calls to relevant classes to simulate what does the script processing do and fetch missing
      values
- Optimise Redux store to speed up FE when the attached network become massive
    - Reduce data stored and optimise selectors (memoization)
- Polish Parameters Management appearance (FE)
